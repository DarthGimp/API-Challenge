This code was written by me with assistance from my work Ai Maharal.
